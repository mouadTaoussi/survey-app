<!DOCTYPE html>
<html>
<head>
	<title>Dashboard</title>
	<%-include(".././partials/HeadTags")%>
</head>
<body>
<%-include(".././partials/HeaderElement", {avatar:user.avatar})%>
<div class="local-container-8">
	<!-- Dynamic alert message -->
	<%-include(".././partials/alertMessage")%>
	<div class="row mt-4">
	<!-- Side bar -->
	  <div class="col-3">
	    <div class="list-group list-group-dashboard" id="list-tab" role="tablist">
	      <a class="list-group-item list-group-item-action active" id="list-home-list" data-toggle="list" href="#list-home" role="tab" aria-controls="home">Your Surveys</a>
	      <a class="list-group-item list-group-item-action" id="list-profile-list" data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">Your Profile</a>
	      <a class="list-group-item list-group-item-action" id="list-settings-list" data-toggle="list" href="#list-settings" role="tab" aria-controls="settings">Settings</a>
	    </div>
	  </div>
	  <div class="col-9">
	  	<% if ( infos.length > 0 ) { %>
	  	
	  		<% infos.forEach((info)=>{ %>
	  			<div class="local-alert info mb-4"><%= info %></div>
	  		<% }) %>

	  	<% } %>
	  	<!-- tabs section -->
	    <div class="tab-content" id="nav-tabContent">
	    <!-- Surveys tab -->
	      <div style="position: relative;"class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
	      	<h3 class="text-left local-mb-4">Your Surveys</h3>
	      	<!-- <button class="local-btn create-btn local-btn-primary">New survey +</button>
	      	<style>
	      		.create-btn  {
	      			position: absolute;
	      			top: 0;
	      			right: 0;
	      		}
	      	</style> -->
	      	<table class="table table-hover">
	      	  <% if (surveys.length == 0) { %>
	      	   	<div class="empty-content"></div>
	      	  <% } %>
	      	  <% if (surveys.length > 0) { %>
				<thead style="background-color:rgba(0,0,0,.1); font-family: 'Poppins';">
				    <tr>
				      <th scope="col">Survey ID</th>
				      <th scope="col">Survey Title</th>
				      <th scope="col">Active</th>
				      <th scope="col"></th>
				      <th scope="col"></th>
				    </tr>
				  </thead>
				<tbody>
				<% surveys.forEach((survey)=>{%> 
				  <tr>
				    <td><a href="/surveyEditor?survey_id=<%= survey.id %>&user_id=<%= survey.user_id %>"><%= survey.id %></a></td>
				    <td><%= survey.title %></td>
				    <td>
				    	<p class="badge <% if (survey.active) {%><%= 'badge-success' %><%} else { %><%= 'badge-danger' %><% } %>">
				    	<%= survey.active %>
				    	</p>
				    </td>
				    <td>
				    	<button class="local-btn local-btn-danger" onclick="deleteSurvey(event,'<%= survey.id %>')">Delete</button>
				    </td>
				    <td>
				    	<a href="/submitResponse?survey_id=<%= survey.id %>" target="_blank">
				    		<button class="local-btn local-btn-info">Preview</button>
				    	</a>
				    </td>
				  </tr>
				<% }) %>
				<% } %>
			    <tr style="background-color:rgba(0,0,0,.20); cursor: pointer">
			      <td><a class="text-dark" href='/surveyEditor'>Create new survey +</a></td>
			      <td></td>
			      <td></td>
			      <td></td>
			      <td></td>
			    </tr>
				</a>
			  </tbody>
			</table>

	      </div>
	      <!-- user account -->
	      <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">
	      	<h3 class="text-left local-mb-4">Your Account</h3>
	      	<img src="<%= user.avatar %>" class="logo-of-user local-mb-4" width="200" height="200">
	      	<div class="avatar-input">
	
			    <label for="avatar" class="btn"><i class="far fa-edit"></i></label>
			    <input id="avatar" style="visibility:hidden;" type="file" onchange="getAvatar(event)">

		    </div>
		    <br>
		    <br>
		    <div style='background-color: white;' class="user_form local-p-4 shadow local-mb-4">
			    <label for="user_id">Your ID:</label>
			    <input 
				    type="text"
				    id="user_id"
				    name="user_id" 
				    class="form-control user-profile-inputs local-mb-2" 
				    value="<%= user.id %>" 
				    disabled
			    >
			    <label for="firstName">First Name</label>
			    <input 
				    type="text"
				    id="firstName"
				    name="firstName" 
				    class="form-control user-profile-inputs local-mb-2" 
				    placeholder="Enter your First Name" 
				    value="<%= user.fullName.familyName %>" 
				    required
			    >
			    <label for="givenName">Given Name</label>
				<input 
					type="text" 
					id="givenName"
					name="givenName" 
					class="form-control user-profile-inputs local-mb-2" 
					placeholder="Enter your Family Name" 
					value="<%= user.fullName.givenName %>" 
					required
				>
				<label for="username">User Name</label>
				<input 
					type="text" 
					id="username"
					name="username" 
					class="form-control user-profile-inputs local-mb-2" 
					placeholder="Enter your username" 
					value="<%= user.username %>" 
					required
				>
				<label for="email">Email</label>
				<input 
					type="email"
					id="email" 
					name="email" 
					class="form-control user-profile-inputs local-mb-2 local-mb-4" 
					placeholder="Enter your email" 
					value="<%= user.email %>"
					required
				>
		      	<button onclick="updateUser()" class="local-btn local-btn-success local-mb-4">Save Changes</button>
		      	<a href="/auth/logout">
		      		<button class="local-btn local-btn-danger local-mb-4">Log out</button>
		      	</a>
		    </div>
	      </div>
	      <!-- settings  -->
	      <div class="tab-pane fade" id="list-settings" role="tabpanel" aria-labelledby="list-settings-list">
	      	<h3 class="text-left local-mb-4">Settings</h3>
	      	<div class="settings-area">
	      		<label for="email">Your API key:</label>
				<input 
					type="text"
					id="apiKey" 
					name="apiKey" 
					class="form-control user-profile-inputs local-mb-2" 
					placeholder="API KEY" 
					value="<%= user.apiKey %>"
					disabled
				>
				<p class="text-dark" style="font-size: 13px; cursor:pointer;" onclick="regenerateAPIKEY()">Revoke this API KEY</p>
				<label for="email">Display Theme:</label>
				<select class="form-control">
					<option>Light</option>
					<option>Dark</option>
				</select>
	      	</div>
	      </div>
	    </div>
	  </div>
	</div>
	<div style="margin-top: 70px">
	<%-   include('.././partials/footer')   %>
	</div>
</div>
</body>
<%-   include('.././partials/ScriptTags')   %>
</html>
<script>
</script>